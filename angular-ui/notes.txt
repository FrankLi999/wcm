https://blog.angularindepth.com/angular-workspace-no-application-for-you-4b451afcc2ba
https://blog.angularindepth.com/creating-a-library-in-angular-6-87799552e7e5
https://blog.angularindepth.com/creating-a-library-in-angular-6-part-2-6e2bc1e14121
https://blog.angularindepth.com/the-angular-library-series-publishing-ce24bb673275
https://blog.angularindepth.com/npm-peer-dependencies-f843f3ac4e7f

1. Create library projects

   ng new angular-commons --create-application=false
   
   cd angular-commons
   
   generate libraries:
   
   ng generate library rest-client --prefix=restcli
   ng generate library bpw-components --prefix=components
   ng generate library bpw-layout --prefix=layout
   ng generate library bpw-auth --prefix=auth
   ng generate library bpw-dynamic-ui --prefix=dynamicui
   ng generate library bpw-form --prefix=form
   
   generate test app:
   
   ng generate application bpw-tester
   
   #Build
   ## libraries are built in prod mode by default
   ng build rest-client [--watch]
   ng build bpw-components [--watch]
   ng build bpw-layout [--watch]
   ng build bpw-auth [--watch]
   ng build bpw-dynamic-ui [--watch]
   ng build bpw-form [--watch]
   
   ng build bpw-tester --prod
   
   #serve
   ng serve bpw-tester
   
   #Test
   ng test rest-client
   ng test bpw-components
   ng test bpw-layout
   ng test bpw-auth
   ng test bpw-dynamic-ui
   ng test bpw-form
   
   ng test bpw-tester
   
   #create a new library components
   ng generate component my-widget --project=bpw-components
   
   #Exporting the component from library’s modules
   
   # Adding the component to the entry file
   export * from './lib/my-widget/my-widget.component';
   
3. packaging

   > Root package.json
   This is the main package.json file for our library workspace. 
   Use this to list dependencies for both the application and the 
   library. Any package that is needed to run or build either the
   application or the project must be in here.

   > Library project package.json
   It tells ng-packagr what information goes into the distribution 
   package.json that will be shipped with the library
   
	name: name of the lib. used in "import {...} from 'lib_name'"
	version: The version of the library. https://semver.org/
	dependency: This contains only the dependencies necessary to run the library
	    can have both dependencies and peerDependencies but not devDependencies 
		in this one
	> Library distribution package.json
	The library distribution package.json is generated by ng-packagr
	
	> packing
		"scripts": {
		  ...
		  "build_lib": "ng build example-ng6-lib",
		  "npm_pack": "cd dist/example-ng6-lib && npm pack",
		  "package": "npm run build_lib && npm run npm_pack"
		  ...
		},
		
		this created "example-ng6-lib-0.0.1.tgz"
	> Using the Library in a Separate Application
      npm install ../example-ng6-lib/dist/example-ng6-lib/example-ng6-lib-0.0.1.tgz	
	
	> npm deal with conflict versions

		npm deals with version conflicts by adding duplicate 
		private versions of the conflicted package.
		
		so if you add a package to your dependencies, there is 
		a chance it may end up being duplicated in node_modules.
		
		The key is:
		We don’t want our library adding another version of a 
		package to node-modules when that package could conflict 
		with an existing version and cause problems.
		
		The Guidelines
		> Favor using Peer Dependencies when one of the following is true:
			o Having multiple copies of a package would cause 
				conflicts
			o The dependency is visible in your interface
			o You want the developer to decide which version to 
				install
		
		Let’s take the example of angular/core. Obviously, if you 
			are creating an Angular Library, angular/core is going 
			to be a very visible part of your library’s interface. 
			Hence, it belongs in your peerDependencies.
		However, maybe your library uses Moment.js internally to 
			process some time related inputs. Moment.js most likely 
			won’t be exposed in the interface of your Angular Services 
			or Components. Hence, it belongs in your dependencies.

		Angular as a Dependency
			“Do I even need to specify angular/core as a dependency?
			If someone is using my library, they will already have an 
			existing Angular project.”
			
			However, it really needs to tell the developer which 
			Angular versions our library is compatible with.
			
			Add at least angular/core for the compatible Angular 
			version to your peerDependencies.
			
			
	> peer-dependencies
	
	Peer Dependencies are used to specify that our package is 
	compatible with a specific version of an npm package.
	
	To add a Peer Dependency you actually need to manually modify
	your package.json file.
	
	When you add a package in dependencies, you are saying:
		My code needs this package to run.
		If this package doesn’t already exist in my node_modules 
			directory, then add it automatically.
		Furthermore, add the packages that are listed in the 
			package’s dependencies. These packages are called 
			transitive dependencies.
			
		npm install lodash
		
	By adding a package in peerDependencies you are saying:
		My code is compatible with this version of the package.
		If this package already exists in node_modules, do nothing.
		If this package doesn’t already exist in the node_modules 
			directory or it is the wrong version, don’t add it. 
			But, show a warning to the user that it wasn’t found.

	
4. publish 
    https://docs.npmjs.com/files/package.json.
	if want to add information, you need to add it in you Library’s Project 
	package.json.
	
	"scripts": {
	  ...
	  "build_lib": "ng build ng-example-library",
	  "copy-license": "copy .\\LICENSE .\\dist\\ng-example-library",
	  "copy-readme": "copy .\\README.md .\\dist\\ng-example-library",
	  "copy-files": "npm run copy-license && npm run copy-readme",
	  "npm_pack": "cd dist/ng-example-library && npm pack",
	  "package": "npm run build_lib && npm run copy-files && npm run npm_pack",
	  ...
	},
	
	project's package.json:
	
	License: Reference the LICENSE file.
	Repository; Point to the GitHub repository.
	Description: Key words
	Home page: Point to this article.
	
	{
	  "name": "ng-example-library",
	  "version": "1.2.0",
	  "description": "This is a simple example Angular Library published to npm.",
	  "keywords" :["Angular","Library"],
	  "license" : "SEE LICENSE IN LICENSE",
	  "repository": {
		"type" : "git",
		"url" : "https://github.com/t-palmer/ng-example-library"
	  },
	  "homepage" :"https://medium.com/@palmer_todd/the-angular-library-series-publishing-ce24bb673275",
	  "peerDependencies": {
		"@angular/common": "^6.0.0-rc.0 || ^6.0.0",
		"@angular/core": "^6.0.0-rc.0 || ^6.0.0"
	  }
	}
	
	npm login
    npm whoami
	npm publish ./dist/ng-example-library/ng-example-library-1.2.0.tgz
	
	https://www.npmjs.com/package/ng-example-library
	
	
5. tsconfig.json, package.json, ng-package.json file of the libraries

	"peerDependencies"

6. Utilize angular libraries within/cross workspace
   within workspace:
	in tsconfig.json of the workspace, the following are added:
		"paths": {
		  "rest-client": [
			"dist/rest-client"
		  ],
		  "rest-client/*": [
			"dist/rest-client/*"
		  ],
		  "bpw-layout": [
			"dist/bpw-layout"
		  ],
		  "bpw-layout/*": [
			"dist/bpw-layout/*"
		  ],
		  "bpw-components": [
			"dist/bpw-components"
		  ],
		  "bpw-components/*": [
			"dist/bpw-components/*"
		  ],
		  "bpw-auth": [
			"dist/bpw-auth"
		  ],
		  "bpw-auth/*": [
			"dist/bpw-auth/*"
		  ],
		  "bpw-dynamic-ui": [
			"dist/bpw-dynamic-ui"
		  ],
		  "bpw-dynamic-ui/*": [
			"dist/bpw-dynamic-ui/*"
		  ],
		  "bpw-form": [
			"dist/bpw-form"
		  ],
		  "bpw-form/*": [
			"dist/bpw-form/*"
		  ]
		}
	 

4. ng-packagr

5. plug and play

   
   